<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport"/>
<meta content="#1b191b" name="theme-color"/>
<meta content="dark" name="color-scheme"/>
<title>Trader Prep</title>
<!-- Icons / Manifest -->
<link href="favicon-32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="icon-192.png" rel="apple-touch-icon"/>
<link href="manifest.webmanifest" rel="manifest"/>
<!-- Icons (CDN, free) -->
<link crossorigin="" href="https://cdnjs.cloudflare.com" rel="preconnect"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" referrerpolicy="no-referrer" rel="stylesheet"/>












































<link rel="stylesheet" href="style.css"/>
</head>
<body>
<!-- HEADER -->
<header class="topbar">
<div class="brand">
<div class="logo"><img alt="Trader Prep Logo" src="icon-192.png" style="width:100%;height:100%;object-fit:contain"/></div>
<h1>Trader Prep</h1>
</div>
<nav class="navicons">
  <div class="iconbtn" id="nav-bell" title="Notifications"><i id="bellIcon" class="fa-regular fa-bell"></i></div>
  <div class="iconbtn" id="nav-watch" title="Stock Watcher"><i class="fa-regular fa-eye"></i></div>
<div class="iconbtn active" id="nav-prep" title="Prep"><i class="fa-solid fa-bars-staggered"></i></div>
<div class="iconbtn" id="nav-trend" title="Trend"><i class="fa-solid fa-wave-square"></i></div>
<div class="iconbtn" id="nav-risk" title="Risk"><i class="fa-solid fa-fire-flame-curved"></i></div>
<div class="iconbtn" id="nav-pnl" title="Profit Log"><i class="fa-solid fa-dollar-sign"></i></div>

<div class="iconbtn" id="nav-settings" title="Settings"><i class="fa-solid fa-gear"></i></div>
</nav>
</header>
<!-- STATS -->
<div class="statstrip">
<div class="chip" id="chipAKWrap"><span class="muted">AK$ (today):</span> <strong id="chipAK">$0.00</strong><span class="muted" style="margin-left:8px">/ all:</span> <span class="pill" id="chipAKAllWrap"> <strong id="chipAKAll">$0.00</strong></span></div>
<div class="chip" id="chipBGWrap"><span class="muted">BG$ (today):</span> <strong id="chipBG">$0.00</strong><span class="muted" style="margin-left:8px">/ all:</span> <span class="pill" id="chipBGAllWrap"> <strong id="chipBGAll">$0.00</strong></span></div>
<div class="chip ok" id="conn1"><i class="fa-solid fa-signal"></i> API OK</div>
<div class="chip ok" id="conn2"><i class="fa-solid fa-chart-line"></i> Data OK</div>
</div>
<div class="wrap">
<!-- SETTINGS -->
<div class="card" id="panel-settings" style="display:none">
<div class="row"><strong>Settings</strong><span class="muted">(Keys optional; proxy fallback built-in)</span></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Custom Proxy</label><input id="customProxy" placeholder="https://script.google.com/macros/s/.../exec?url="/></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">GNews API Key</label><input id="gnews" placeholder="gnews.io token"/></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Alpha Vantage Key</label><input id="alpha" placeholder="alphavantage.co key"/></div>
<div class="actions" style="margin-top:10px"><button class="primary" id="saveKeys"><i class="fa-regular fa-floppy-disk"></i> Save Keys</button><button id="testFetch"><i class="fa-solid fa-vial"></i> Test Data Fetch</button><span class="muted" id="saveMsg"></span></div>
<div class="muted" id="diag" style="margin-top:8px;font-size:13px"></div>
</div>
<!-- PNL -->
<div class="card" id="panel-pnl" style="display:none">
<div class="row"><strong>Daily P&amp;L Log</strong><span class="muted">(updates AK$/BG$ chips for today)</span></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Who</label><div class="actions"><label><input checked="" name="who" type="radio" value="AK"/> AK</label><label style="margin-left:10px"><input name="who" type="radio" value="BG"/> BG</label></div></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Amount ($)</label><input id="pnlAmount" placeholder="e.g. 125.50 or -75"/></div>
<div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Note (optional)</label><input id="pnlNote" placeholder="scalp NQ open, etc."/></div>
<div class="actions" style="margin-top:10px"><button class="primary" id="logPnl"><i class="fa-solid fa-plus"></i> Log Profit</button><span class="muted" id="pnlMsg"></span></div>
</div>
<div id="multiSymbolTabs" class="tabs" aria-label="Open symbols"></div>
<!-- MARKET PICKER -->
<div class="card">
<!-- Hide the Prep/Trend/Risk tabs row; navigation is handled via the top bar -->
<div class="tabs" style="display:none">
<button class="tabbtn active" id="tab-prep">Prep</button>
<button class="tabbtn" id="tab-trend">Trend</button>
<button class="tabbtn" id="tab-risk">Risk</button>
</div>
<div class="heading-row" style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;"><strong>Choose your markets</strong><span id="mktStatus" class="pill warn" style="margin-left:6px;">Market hours</span></div>
<div class="bundles">
<button class="bundle" data-bundle="ES,NQ,YM,RTY">US Indices</button>
<button class="bundle" data-bundle="CL,GC">Energy &amp; Gold</button>
<button class="bundle" data-bundle="ZN,6E">Rates / FX</button>
</div>
<div class="grid" style="margin-top:10px">
<div>
<label class="muted">Futures/markets</label>
<select aria-label="Futures and markets" id="futures" multiple="" size="8">
<option value="ES">ES – S&amp;P 500</option>
<option value="NQ">NQ – Nasdaq 100</option>
<option value="YM">YM – Dow</option>
<option value="RTY">RTY – Russell 2000</option>
<option value="CL">CL – Crude Oil</option>
<option value="GC">GC – Gold</option>
<option value="ZN">ZN – 10-Yr Note</option>
<option value="6E">6E – EUR/USD</option>
</select>
</div>
<div>
<div class="muted">Trend/Risk timeframe</div>
<div class="seg" style="margin-top:6px">
<button class="segbtn active" data-tf="15">15m</button>
<button class="segbtn" data-tf="30">30m</button>
<button class="segbtn" data-tf="60">60m</button>
</div>
<div class="muted" style="margin-top:6px">Trend/Risk use 1-minute Yahoo bars (via your proxy), mapped futures → ETFs.</div>
</div>
</div>
<div class="actions" style="margin-top:12px">
<button class="primary" id="start"><i class="fa-solid fa-bolt"></i> Analyze (Prep)</button>
<button class="primary" id="runTrend"><i class="fa-solid fa-wave-square"></i> Analyze (Trend)</button>
<button class="primary" id="runRisk"><i class="fa-solid fa-fire-flame-curved"></i> Analyze (Risk)</button>
</div>
</div>
<!-- PREP -->
<div class="card" id="prepOut">
<div class="row"><strong>Trader Prep</strong><span class="muted">Now: <span id="now"></span></span></div>
<div class="muted">Focus: <span id="focus"></span> • <span id="keyStatus"></span></div>
<div id="summary" style="margin-top:12px"></div>
<h3 style="margin-top:16px">Quick Links</h3>
<ul id="links"></ul>
</div>
<!-- TREND -->
<div class="card" id="trendOut" style="display:none">
<div class="row"><strong>Current Trend</strong><span class="muted">Window: <span id="trendWin">15m</span></span></div>
<div class="muted">Primary: <span id="trendSym"></span> (mapped ETF) • <span id="trendTime"></span></div>
<div id="trendSummary" style="margin-top:12px"></div>
<canvas class="chart" id="trendChart"></canvas>
<div class="legend" id="trendLegend"></div>
<div id="trendAdvice" style="margin-top:12px"></div>
<div class="muted" style="margin-top:6px;font-size:12px">Last refreshed: <span id="trendRef">—</span></div>
<details style="margin-top:10px"><summary>How we decide “busy”</summary>
<div class="muted" style="margin-top:6px">We compute 1-minute returns and flag as <b>Busy</b> when realized vol in the window is elevated (≥ ~0.06% std-dev) or average volume is above the window’s median (≥ 1.2×).</div>
</details>
</div>
<!-- RISK -->
<div class="card" id="riskQuickTabs" class="tabs" aria-label="Quick switch between selected symbols"></div>
<div id="riskOut" style="display:none">
<div class="row"><strong>Risk Read</strong><span class="muted">Window: <span id="riskWin">15m</span></span></div>
<div class="seg" id="riskModeSeg" style="margin:6px 0 2px">
<button class="segbtn active" data-mode="conservative">Conservative</button>
<button class="segbtn" data-mode="aggressive">Aggressive</button>
<!-- The candles count pill is no longer displayed next to the mode buttons; it will appear next to the slider instead -->
</div>
<div class="sliderrow" style="margin:4px 0 8px">
<!-- Candles label and slider: show the candles count pill directly to the left of the slider -->
<span class="muted" style="min-width:120px">Candles (1m each)</span>
<span class="pill" id="riskCandlesLabel" style="margin-left:0">3 candles</span>
<input aria-label="Risk candles" id="riskCandles" max="15" min="3" step="1" type="range" value="3"/>
</div>
<div class="muted">Primary: <span id="riskSym"></span> (mapped ETF) • <span id="riskTime"></span></div>
<div id="riskSummary" style="margin-top:12px"></div>
<canvas class="chart" id="riskChart"></canvas>
<div class="legend" id="riskLegend"></div>
<div id="riskAdvice" style="margin-top:12px"></div>
<div class="muted" style="margin-top:6px;font-size:12px">Last refreshed: <span id="riskRef">—</span></div>
</div>
</div>

<!-- Explain Modal -->
<div class="modal" id="explainModal" style="display:none;position:fixed;inset:0;z-index:200;align-items:center;justify-content:center;background:rgba(0,0,0,.6)">
<div class="box" style="max-width:640px;width:calc(100% - 28px);background:var(--panel);border:1px solid var(--line);border-radius:14px;box-shadow:var(--shadow);padding:16px">
<div class="row" style="justify-content:space-between;align-items:center">
<strong id="explainTitle">Why?</strong>
<button aria-label="Close" class="iconbtn" id="explainClose"><i class="fa-solid fa-xmark"></i></button>
</div>
<div class="muted" id="explainBody" style="margin-top:10px;line-height:1.5"></div>
</div>
</div>
<!-- Slider adjustment confirmation -->
<div id="sliderConfirm" style="display:none;position:fixed;inset:0;z-index:300;align-items:center;justify-content:center;background:rgba(0,0,0,0.65)">
<div style="background:var(--panel);border:1px solid var(--line);box-shadow:var(--shadow);border-radius:14px;padding:20px;max-width:320px;width:calc(100% - 40px);color:var(--fg)">
<div class="muted">Moving the candles slider will look at more bars and may change the recommendation.</div>
<div class="actions" style="margin-top:14px;justify-content:flex-end;gap:10px">
<button class="primary" id="sliderAccept">Accept</button>
<button id="sliderCancel">Cancel</button>
</div>
</div>
</div>
<!-- slider bubble sync (minimal) -->




















































<script src="main.js"></script>
</body>
</html>
