<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#1b191b"/>
  <meta name="color-scheme" content="dark"/>
  <title>Trader Prep</title>
  <link rel="icon" href="favicon-32.png" sizes="32x32" type="image/png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" referrerpolicy="no-referrer"/>
  <style>
    :root{--bg:#1b191b;--panel:#2a292f;--panel-2:#242328;--line:#35343a;--fg:#f1f2f4;--muted:#a7adbb;--accent:#6424ac;--accent-graph:#7c5cff;--ok:#6abd74;--bad:#e05d5d;--warn:#d3a54a;--pill:#24252b;--shadow:0 6px 18px rgba(0,0,0,.35);--radius:14px;--pad:16px}
    html,body{background:var(--bg);color:var(--fg)}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;margin:0;line-height:1.35;word-break:break-word}
    .topbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(180deg,#201f25 0%,#1a191f 100%);border-bottom:1px solid var(--line);padding:10px 14px}
    .brand{display:flex;gap:10px;align-items:center;min-width:0}.brand .logo{width:36px;height:36px;display:grid;place-items:center;border-radius:10px;background:#2f2e36;border:1px solid var(--line);overflow:hidden;flex:0 0 auto}.brand .logo img{width:100%;height:100%;object-fit:contain}.brand h1{font-size:16px;margin:0;letter-spacing:.3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .navicons{display:flex;gap:10px;align-items:center}.iconbtn{min-width:44px;min-height:44px;display:grid;place-items:center;border-radius:12px;border:1px solid var(--line);background:#26252b;cursor:pointer;color:#cfd3dc}.iconbtn.active{background:var(--accent);color:#090909;border-color:transparent}
    .statstrip{display:flex;gap:10px;align-items:center;padding:10px 14px;flex-wrap:wrap;border-bottom:1px solid var(--line);background:#1e1d22}
    .chip{display:flex;gap:8px;align-items:center;padding:6px 10px;background:#2a2930;border:1px solid var(--line);border-radius:10px;font-size:12px}
    .chip.ok{background:#213224;color:var(--ok);border-color:#2a4930}.chip.warn{background:#332d1f;color:var(--warn);border-color:#5a4726}.chip.bad{background:#372325;color:var(--bad);border-color:#5d3439}
    .wrap{max-width:1100px;margin:0 auto;padding:14px}.card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:var(--pad);box-shadow:var(--shadow);margin:14px 0}
    .muted{color:var(--muted)}.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.actions{display:flex;gap:10px;flex-wrap:wrap}
    button,select,input{font-size:15px}select,input{background:var(--panel-2);color:var(--fg);border:1px solid var(--line);border-radius:12px;padding:12px 12px;width:100%}button{padding:12px 16px;border-radius:12px;border:1px solid var(--line);background:var(--panel-2);color:var(--fg);cursor:pointer}.primary{background:var(--accent);color:#0b0b10;border-color:transparent;font-weight:600}
    .tabs{display:flex;gap:10px;margin:8px 0 2px;flex-wrap:wrap}.tabbtn{border-radius:10px;border:1px solid var(--line);background:#26252b;padding:8px 12px;cursor:pointer}.tabbtn.active{background:var(--accent);color:#0b0b10;border-color:transparent}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:6px 12px;border-radius:999px;background:var(--pill);border:1px solid var(--line);font-size:13px}.pill.accent{background:var(--accent);color:#0b0b10;border-color:transparent}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}@media (max-width:900px){.grid{grid-template-columns:1fr}}
    .chart{width:100%;height:190px;border-radius:10px;background:#24252b;margin-top:10px;display:block}
    .legend{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:8px;font-size:12px;color:var(--muted)}.legend .item{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:10px;border:1px solid var(--line);background:#26252b}
    .swatch{display:inline-block;width:20px;height:10px;border-radius:2px}.swatch.line{width:28px;height:0;border-top:3px solid currentColor}.swatch.dashed{border-top-style:dashed}
    #mobileMenu{display:none}@media (max-width:520px){#mobileMenu{display:grid}#navicons{display:none;position:absolute;right:8px;top:calc(100% + 6px);background:#26252b;border:1px solid var(--line);border-radius:12px;padding:6px;box-shadow:var(--shadow);z-index:60}#navicons.show{display:flex}}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand"><div class="logo"><img src="icon-192.png" alt=""></div><h1>Trader Prep</h1></div>
    <nav class="navicons" id="navicons">
      <div class="iconbtn active" id="nav-prep" title="Prep"><i class="fa-solid fa-bars-staggered"></i></div>
      <div class="iconbtn" id="nav-trend" title="Trend"><i class="fa-solid fa-wave-square"></i></div>
      <div class="iconbtn" id="nav-risk" title="Risk"><i class="fa-solid fa-fire-flame-curved"></i></div>
      <div class="iconbtn" id="nav-pnl" title="P&L"><i class="fa-solid fa-dollar-sign"></i></div>
      <div class="iconbtn" id="nav-settings" title="Settings"><i class="fa-solid fa-gear"></i></div>
    </nav>
    <button class="iconbtn" id="mobileMenu" title="Menu"><i class="fa-solid fa-ellipsis-vertical"></i></button>
  </header>

  <div class="statstrip">
    <div class="chip" id="chipAKWrap"><span class="muted">AK$ (today):</span> <strong id="chipAK">$0.00</strong><span class="muted" style="margin-left:8px">/ all:</span> <strong id="chipAKAll">$0.00</strong></div>
    <div class="chip" id="chipBGWrap"><span class="muted">BG$ (today):</span> <strong id="chipBG">$0.00</strong><span class="muted" style="margin-left:8px">/ all:</span> <strong id="chipBGAll">$0.00</strong></div>
    <div class="chip warn" id="conn1"><i class="fa-solid fa-signal"></i> Unknown</div>
    <div class="chip warn" id="conn2"><i class="fa-solid fa-chart-line"></i> Unknown</div>
  </div>

  <div class="wrap">
    <div class="card" id="panel-settings" style="display:none">
      <div class="row"><strong>Settings</strong><span class="muted">(Use your proxy if possible for reliability)</span></div>
      <div class="row" style="margin-top:8px"><label class="muted" style="min-width:180px">Custom Proxy (Apps Script web app)</label><input id="customProxy" placeholder="https://script.google.com/macros/s/.../exec?url="></div>
      <div class="row" style="margin-top:8px"><label class="muted" style="min-width:180px">GNews API Key</label><input id="gnews" placeholder="gnews.io token"></div>
      <div class="row" style="margin-top:8px"><label class="muted" style="min-width:180px">Alpha Vantage Key</label><input id="alpha" placeholder="alphavantage.co key"></div>
      <div class="actions" style="margin-top:8px">
        <button id="saveKeys" class="primary"><i class="fa-regular fa-floppy-disk"></i>&nbsp;Save</button>
        <button id="testFetch"><i class="fa-solid fa-vial"></i>&nbsp;Test Data Fetch</button>
        <span id="saveMsg" class="muted"></span>
      </div>
      <div id="diag" class="muted" style="margin-top:10px;font-size:13px"></div>
    </div>

    <div class="card" id="panel-pnl" style="display:none">
      <div class="row"><strong>Daily P&L Log</strong><span class="muted">(updates chips)</span></div>
      <div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Who</label><div class="actions"><label><input type="radio" name="who" value="AK" checked> AK</label><label style="margin-left:10px"><input type="radio" name="who" value="BG"> BG</label></div></div>
      <div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Amount ($)</label><input id="pnlAmount" placeholder="e.g. 125.50 or -75"></div>
      <div class="row" style="margin-top:10px"><label class="muted" style="min-width:170px">Note (optional)</label><input id="pnlNote" placeholder="scalp NQ open, etc."></div>
      <div class="actions" style="margin-top:10px"><button id="logPnl" class="primary"><i class="fa-solid fa-plus"></i>&nbsp;Log</button><span id="pnlMsg" class="muted"></span></div>
      <details style="margin-top:12px"><summary>Today’s entries</summary><div id="pnlTodayTable" class="muted" style="margin-top:8px">—</div><div class="actions" style="margin-top:8px"><button id="undoLast"><i class="fa-solid fa-rotate-left"></i>&nbsp;Undo last</button></div></details>
    </div>

    <div class="card" id="panel-picker">
      <div class="tabs">
        <button class="tabbtn active" id="tab-prep">Prep</button>
        <button class="tabbtn" id="tab-trend">Trend</button>
        <button class="tabbtn" id="tab-risk">Risk</button>
      </div>
      <strong>Choose your markets</strong>
      <div class="grid" style="margin-top:10px">
        <div>
          <label class="muted">Futures/markets</label>
          <select id="futures" multiple size="8" aria-label="Futures and markets">
            <option value="ES">ES – S&P 500</option><option value="NQ">NQ – Nasdaq 100</option><option value="YM">YM – Dow</option><option value="RTY">RTY – Russell 2000</option><option value="CL">CL – Crude Oil</option><option value="GC">GC – Gold</option><option value="ZN">ZN – 10-Yr Note</option><option value="6E">6E – EUR/USD</option>
          </select>
        </div>
        <div>
          <div class="muted">Timeframe for Trend/Risk</div>
          <div class="actions" id="tfSeg" style="margin-top:6px"><button class="tabbtn" data-tf="15">15m</button><button class="tabbtn" data-tf="30">30m</button><button class="tabbtn" data-tf="60">60m</button></div>
          <div class="muted" style="margin-top:6px">Data: Yahoo 1m via proxy; headlines via GNews or Google News RSS via proxy.</div>
        </div>
      </div>
      <div class="actions" style="margin-top:12px">
        <button id="start" class="primary"><i class="fa-solid fa-bolt"></i>&nbsp;Analyze (Prep)</button>
        <button id="runTrend" class="primary"><i class="fa-solid fa-wave-square"></i>&nbsp;Analyze (Trend)</button>
        <button id="runRisk" class="primary"><i class="fa-solid fa-fire-flame-curved"></i>&nbsp;Analyze (Risk)</button>
      </div>
    </div>

    <div id="prepOut" class="card">
      <div class="row"><strong>Trader Prep</strong><span class="muted">Now: <span id="now"></span></span></div>
      <div class="muted">Focus: <span id="focus"></span> • <span id="keyStatus"></span></div>
      <div id="summary" style="margin-top:12px"></div>
      <h3 style="margin-top:16px">Quick Links</h3><ul id="links"></ul>
    </div>

    <div id="trendOut" class="card" style="display:none">
      <div class="row"><strong>Current Trend</strong><span class="muted">Window: <span id="trendWin">15m</span></span></div>
      <div class="muted">Primary: <span id="trendSym"></span> • <span id="trendTime"></span></div>
      <div id="trendSummary" style="margin-top:12px"></div>
      <canvas id="trendChart" class="chart"></canvas>
      <div id="trendLegend" class="legend"></div>
      <div id="trendAdvice" style="margin-top:12px"></div>
      <div class="muted" style="margin-top:6px;font-size:12px">Last refreshed: <span id="trendRef">—</span></div>
    </div>

    <div id="riskOut" class="card" style="display:none">
      <div class="row"><strong>Risk Read</strong><span class="muted">Window: <span id="riskWin">15m</span></span></div>
      <div class="muted">Primary: <span id="riskSym"></span> • <span id="riskTime"></span></div>
      <div id="riskSummary" style="margin-top:12px"></div>
      <canvas id="riskChart" class="chart"></canvas>
      <div id="riskLegend" class="legend"></div>
      <div id="riskAdvice" style="margin-top:12px"></div>
      <div class="muted" style="margin-top:6px;font-size:12px">Last refreshed: <span id="riskRef">—</span></div>
    </div>
  </div>

  <script id="app-bootstrap">(function(){
  try {
    const code = document.getElementById('app-code').textContent;
    (0,eval)(code);
  } catch(e){ console.error('bootstrap error', e); }
})();</script>
<script id="app-bootstrap">
(function(){
  try {
    var _b64 = 'CgogIC8qID09PT09PT09IFJvYnVzdCBwcm94eSBmYWxsYmFjayA9PT09PT09PSAqLwogIGZ1bmN0aW9uIGdldEN1c3RvbVByb3h5KCl7cmV0dXJuIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQ1VTVE9NX1BST1hZJyl8fCcnKS50cmltKCl9CiAgY29uc3QgUFJPWElFUyA9IFsKICAgICcnLCAvLyBkaXJlY3QgKHdpbGwgZmFpbCBDT1JTIGZyb20gYnJvd3NlciwgYnV0IHRyeSkKICAgICgpID0+IGdldEN1c3RvbVByb3h5KCksIC8vIHlvdXIgQXBwcyBTY3JpcHQgaWYgc2V0CiAgICAnaHR0cHM6Ly9hcGkuYWxsb3JpZ2lucy53aW4vcmF3P3VybD0nIC8vIHB1YmxpYyBmYWxsYmFjawogIF07CiAgZnVuY3Rpb24gd3JhcFVybCh1LCBpZHgpewogICAgY29uc3QgcCA9IFBST1hJRVNbaWR4XTsKICAgIGlmICh0eXBlb2YgcCA9PT0gJ2Z1bmN0aW9uJyl7IGNvbnN0IHYgPSBwKCk7IHJldHVybiB2ID8gdiArIGVuY29kZVVSSUNvbXBvbmVudCh1KSA6IG51bGw7IH0KICAgIGlmICghcCkgcmV0dXJuIHU7IC8vIGRpcmVjdAogICAgcmV0dXJuIHAgKyBlbmNvZGVVUklDb21wb25lbnQodSk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiBmZXRjaFdpdGhGYWxsYmFjayh1cmwsIHR5cGU9J2pzb24nLCB0aW1lb3V0PTEwMDAwKXsKICAgIGxldCBsYXN0RXJyPW51bGwsIHVzZWQ9Jyc7CiAgICBmb3IgKGxldCBpPTA7aTxQUk9YSUVTLmxlbmd0aDtpKyspewogICAgICBjb25zdCB3cmFwcGVkID0gd3JhcFVybCh1cmwsIGkpOwogICAgICBpZiAoIXdyYXBwZWQpIGNvbnRpbnVlOwogICAgICB0cnl7CiAgICAgICAgY29uc3QgYyA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsgY29uc3QgdG8gPSBzZXRUaW1lb3V0KCgpPT5jLmFib3J0KCd0aW1lb3V0JyksIHRpbWVvdXQpOwogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHdyYXBwZWQsIHtzaWduYWw6Yy5zaWduYWwsIGNhY2hlOiduby1zdG9yZSd9KTsKICAgICAgICBjbGVhclRpbWVvdXQodG8pOwogICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ0hUVFAgJytyZXMuc3RhdHVzKTsKICAgICAgICB1c2VkID0gKHR5cGVvZiBQUk9YSUVTW2ldID09PSAnZnVuY3Rpb24nKSA/ICdjdXN0b21Qcm94eScgOiAoUFJPWElFU1tpXSB8fCAnZGlyZWN0Jyk7CiAgICAgICAgcmV0dXJuIHsgb2s6dHJ1ZSwgdXNlZCwgZGF0YTogKHR5cGU9PT0nanNvbicpID8gYXdhaXQgcmVzLmpzb24oKSA6IGF3YWl0IHJlcy50ZXh0KCkgfTsKICAgICAgfWNhdGNoKGUpeyBsYXN0RXJyPWU7IH0KICAgIH0KICAgIHJldHVybiB7IG9rOmZhbHNlLCBlcnJvcjpTdHJpbmcobGFzdEVycnx8J3Vua25vd24nKSwgdXNlZCB9OwogIH0KCiAgLyogPT09PT09PT0gU2V0dGluZ3MgJiBEaWFnbm9zdGljcyA9PT09PT09PSAqLwogIGNvbnN0IHBhbmVsU2V0dGluZ3M9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhbmVsLXNldHRpbmdzJyk7CiAgY29uc3QgcGFuZWxQbkw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhbmVsLXBubCcpOwogIGNvbnN0IG5hdlByZXA9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdi1wcmVwJyksbmF2VHJlbmQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdi10cmVuZCcpLG5hdlNldHRpbmdzPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtc2V0dGluZ3MnKSxuYXZQbkw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdi1wbmwnKSxuYXZSaXNrPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtcmlzaycpOwogIGZ1bmN0aW9uIGhpZGVQYW5lbHMoKXtwYW5lbFNldHRpbmdzLnN0eWxlLmRpc3BsYXk9J25vbmUnO3BhbmVsUG5MLnN0eWxlLmRpc3BsYXk9J25vbmUnfQogIGZ1bmN0aW9uIHNldE5hdihhY3RpdmUpewogICAgW25hdlByZXAsbmF2VHJlbmQsbmF2U2V0dGluZ3MsbmF2UG5MLG5hdlJpc2tdLmZvckVhY2gobj0+bi5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLG4uaWQ9PT1hY3RpdmUpKTsKICAgIGhpZGVQYW5lbHMoKTsKICAgIGlmKGFjdGl2ZT09PSduYXYtc2V0dGluZ3MnKSBwYW5lbFNldHRpbmdzLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsKICAgIGlmKGFjdGl2ZT09PSduYXYtcG5sJykgcGFuZWxQbkwuc3R5bGUuZGlzcGxheT0nYmxvY2snOwogICAgaWYoYWN0aXZlPT09J25hdi1wcmVwJykgc2V0VGFiKCdwcmVwJyk7CiAgICBpZihhY3RpdmU9PT0nbmF2LXRyZW5kJykgc2V0VGFiKCd0cmVuZCcpOwogICAgaWYoYWN0aXZlPT09J25hdi1yaXNrJykgc2V0VGFiKCdyaXNrJyk7CiAgfQogIG5hdlByZXAub25jbGljaz0oKT0+c2V0TmF2KCduYXYtcHJlcCcpOyBuYXZUcmVuZC5vbmNsaWNrPSgpPT5zZXROYXYoJ25hdi10cmVuZCcpOyBuYXZTZXR0aW5ncy5vbmNsaWNrPSgpPT5zZXROYXYoJ25hdi1zZXR0aW5ncycpOyBuYXZQbkwub25jbGljaz0oKT0+c2V0TmF2KCduYXYtcG5sJyk7IG5hdlJpc2sub25jbGljaz0oKT0+c2V0TmF2KCduYXYtcmlzaycpOwoKICBjb25zdCB0YWJQcmVwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWItcHJlcCcpLCB0YWJUcmVuZD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFiLXRyZW5kJyksIHRhYlJpc2s9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYi1yaXNrJyk7CiAgY29uc3QgcHJlcE91dD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcE91dCcpLCB0cmVuZE91dD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlbmRPdXQnKSwgcmlza091dD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlza091dCcpOwogIGZ1bmN0aW9uIHNldFRhYih3aGljaCl7CiAgICB0YWJQcmVwLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsd2hpY2g9PT0ncHJlcCcpOyB0YWJUcmVuZC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLHdoaWNoPT09J3RyZW5kJyk7IHRhYlJpc2suY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyx3aGljaD09PSdyaXNrJyk7CiAgICBwcmVwT3V0LnN0eWxlLmRpc3BsYXk9KHdoaWNoPT09J3ByZXAnKT8nJzonbm9uZSc7IHRyZW5kT3V0LnN0eWxlLmRpc3BsYXk9KHdoaWNoPT09J3RyZW5kJyk/Jyc6J25vbmUnOyByaXNrT3V0LnN0eWxlLmRpc3BsYXk9KHdoaWNoPT09J3Jpc2snKT8nJzonbm9uZSc7CiAgfQoKICBjb25zdCBjdXN0b21Qcm94eUVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21Qcm94eScpOwogIGNvbnN0IGduZXdzRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2duZXdzJyksIGFscGhhRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FscGhhJyksIHNhdmVCdG49ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVLZXlzJyksIHNhdmVNc2c9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVNc2cnKSwgdGVzdEJ0bj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVzdEZldGNoJyksIGRpYWc9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpYWcnKTsKICBmdW5jdGlvbiBsb2FkS2V5cygpe2duZXdzRWwudmFsdWU9bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0dORVdTX0tFWScpfHwnJzthbHBoYUVsLnZhbHVlPWxvY2FsU3RvcmFnZS5nZXRJdGVtKCdBTFBIQV9LRVknKXx8Jyc7Y3VzdG9tUHJveHlFbC52YWx1ZT1nZXRDdXN0b21Qcm94eSgpfQogIGZ1bmN0aW9uIHNhdmVLZXlzKCl7bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0dORVdTX0tFWScsZ25ld3NFbC52YWx1ZS50cmltKCkpO2xvY2FsU3RvcmFnZS5zZXRJdGVtKCdBTFBIQV9LRVknLGFscGhhRWwudmFsdWUudHJpbSgpKTtsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnQ1VTVE9NX1BST1hZJyxjdXN0b21Qcm94eUVsLnZhbHVlLnRyaW0oKSk7c2F2ZU1zZy50ZXh0Q29udGVudD0nU2F2ZWQg4pyTJztzZXRUaW1lb3V0KCgpPT5zYXZlTXNnLnRleHRDb250ZW50PScnLDE1MDApfQogIHNhdmVCdG4ub25jbGljaz1zYXZlS2V5czsgbG9hZEtleXMoKTsKICB0ZXN0QnRuLm9uY2xpY2s9YXN5bmMoKT0+ewogICAgZGlhZy50ZXh0Q29udGVudD0nVGVzdGluZyBZYWhvbyAxbSB2aWEgZmFsbGJhY2sgY2hhaW4uLi4nOwogICAgY29uc3QgdXJsPSdodHRwczovL3F1ZXJ5MS5maW5hbmNlLnlhaG9vLmNvbS92OC9maW5hbmNlL2NoYXJ0L1NQWT9yYW5nZT0xZCZpbnRlcnZhbD0xbSZpbmNsdWRlUHJlUG9zdD10cnVlJzsKICAgIGNvbnN0IHI9YXdhaXQgZmV0Y2hXaXRoRmFsbGJhY2sodXJsLCdqc29uJywxMDAwMCk7CiAgICBpZihyLm9rKXtkaWFnLmlubmVySFRNTD1gPHNwYW4gY2xhc3M9ImNoaXAgb2siPk9LIHZpYSA8Yj4ke3IudXNlZH08L2I+PC9zcGFuPmA7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uMicpLmNsYXNzTmFtZT0nY2hpcCBvayc7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uMicpLmlubmVySFRNTD0nPGkgY2xhc3M9ImZhLXNvbGlkIGZhLWNoYXJ0LWxpbmUiPjwvaT4gRGF0YSBPSyc7fQogICAgZWxzZSB7ZGlhZy5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJjaGlwIGJhZCI+RmFpbGVkOiAke3IuZXJyb3J9PC9zcGFuPiDigKIgVHJ5IGFkZGluZyBhIGN1c3RvbSBwcm94eSBhYm92ZS5gOyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubjInKS5jbGFzc05hbWU9J2NoaXAgYmFkJzsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm4yJykuaW5uZXJIVE1MPSc8aSBjbGFzcz0iZmEtc29saWQgZmEtY2hhcnQtbGluZSI+PC9pPiBEYXRhIEZBSUwnO30KICB9OwoKICBjb25zdCBmdXR1cmVzU2VsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmdXR1cmVzJyk7CiAgY29uc3Qgc3RhcnRCdG49ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0JyksIHJ1blRyZW5kQnRuPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW5UcmVuZCcpLCBydW5SaXNrQnRuPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdydW5SaXNrJyk7CiAgY29uc3Qgbm93RWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vdycpLCBmb2N1c0VsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2N1cycpLCBzdW1tYXJ5RWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1bW1hcnknKSwgbGlua3NFbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua3MnKTsKICBjb25zdCBrZXlTdGF0dXNFbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2V5U3RhdHVzJyk7CiAgY29uc3QgdHJlbmRXaW5FbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlbmRXaW4nKSwgdHJlbmRTeW1FbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlbmRTeW0nKSwgdHJlbmRUaW1lRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZW5kVGltZScpLCB0cmVuZFN1bW1hcnlFbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlbmRTdW1tYXJ5JyksIHRyZW5kQWR2aWNlRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZW5kQWR2aWNlJyksIHRyZW5kQ2FudmFzPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmVuZENoYXJ0Jyk7CiAgY29uc3Qgcmlza1dpbkVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaXNrV2luJyksIHJpc2tTeW1FbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlza1N5bScpLCByaXNrVGltZUVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaXNrVGltZScpLCByaXNrU3VtbWFyeUVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaXNrU3VtbWFyeScpLCByaXNrQWR2aWNlRWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jpc2tBZHZpY2UnKSwgcmlza0NhbnZhcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlza0NoYXJ0Jyk7CiAgY29uc3QgdHJlbmRMZWdlbmQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZW5kTGVnZW5kJyk7IGNvbnN0IHJpc2tMZWdlbmQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jpc2tMZWdlbmQnKTsKICBjb25zdCBjaGlwRGF0YT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29ubjInKTsKCiAgZnVuY3Rpb24gc2lnbW9pZCh4KXtyZXR1cm4gMS8oMStNYXRoLmV4cCgteCkpfQogIGZ1bmN0aW9uIHN0ZGV2KGFycil7aWYoIWFyci5sZW5ndGgpcmV0dXJuIDA7Y29uc3QgbT1hcnIucmVkdWNlKChhLGIpPT5hK2IsMCkvYXJyLmxlbmd0aDtjb25zdCB2PWFyci5yZWR1Y2UoKGEsYik9PmErKGItbSkqKGItbSksMCkvYXJyLmxlbmd0aDtyZXR1cm4gTWF0aC5zcXJ0KHYpfQogIGZ1bmN0aW9uIGVtYShhcnIsYT0wLjI1KXtjb25zdCBvdXQ9W107bGV0IHM9bnVsbDtmb3IoY29uc3QgeCBvZiBhcnIpe3M9KHM9PW51bGwpP3g6YSp4KygxLWEpKnM7b3V0LnB1c2gocyl9cmV0dXJuIG91dH0KCiAgY29uc3QgRlVUVVJFU19UT19FVEY9e0VTOidTUFknLE5ROidRUVEnLFlNOidESUEnLFJUWTonSVdNJyxDTDonVVNPJyxHQzonR0xEJyxaTjonSUVGJywnNkUnOidGWEUnfTsKCiAgZnVuY3Rpb24gc2l6ZUNhbnZhcyhjYW52YXMpe2NvbnN0IGRwcj1NYXRoLm1heCgxLE1hdGgubWluKDIsd2luZG93LmRldmljZVBpeGVsUmF0aW98fDEpKTtjb25zdCBjc3NXPWNhbnZhcy5jbGllbnRXaWR0aHx8NzAwLGNzc0g9Y2FudmFzLmNsaWVudEhlaWdodHx8MTkwO2NhbnZhcy53aWR0aD1NYXRoLmZsb29yKGNzc1cqZHByKTtjYW52YXMuaGVpZ2h0PU1hdGguZmxvb3IoY3NzSCpkcHIpO3JldHVybntjdHg6Y2FudmFzLmdldENvbnRleHQoJzJkJyksdzpjYW52YXMud2lkdGgsaDpjYW52YXMuaGVpZ2h0LGRwcn19CiAgZnVuY3Rpb24gZHJhd0NhbmRsZUNoYXJ0KGNhbnZhcyxiYXJzKXtjb25zdCB7Y3R4LHcsaH09c2l6ZUNhbnZhcyhjYW52YXMpO2N0eC5jbGVhclJlY3QoMCwwLHcsaCk7aWYoIWJhcnN8fGJhcnMubGVuZ3RoPDIpcmV0dXJuO2NvbnN0IHBhZD0xMjtjb25zdCBoaWdocz1iYXJzLm1hcChiPT5iLmgpLGxvd3M9YmFycy5tYXAoYj0+Yi5sKTtjb25zdCBtaW49TWF0aC5taW4oLi4ubG93cyksbWF4PU1hdGgubWF4KC4uLmhpZ2hzKSxyYW5nZT0obWF4LW1pbil8fDE7Y29uc3Qgc3RlcD0ody1wYWQqMikvKGJhcnMubGVuZ3RoLTEpO2NvbnN0IGJvZHlGcmFjPTAuNjUsYm9keVc9TWF0aC5tYXgoMyxzdGVwKmJvZHlGcmFjKTtjdHguc3Ryb2tlU3R5bGU9JyMyZDJkMzMnO2N0eC5saW5lV2lkdGg9MTtmb3IobGV0IGk9MTtpPD0zO2krKyl7Y29uc3QgeT1wYWQrKGgtcGFkKjIpKihpLzQpO2N0eC5iZWdpblBhdGgoKTtjdHgubW92ZVRvKHBhZCx5KTtjdHgubGluZVRvKHctcGFkLHkpO2N0eC5zdHJva2UoKX1mb3IobGV0IGk9MDtpPGJhcnMubGVuZ3RoO2krKyl7Y29uc3QgYj1iYXJzW2ldLHg9cGFkK3N0ZXAqaTtjb25zdCB5SD1oLXBhZC0oKGIuaC1taW4pL3JhbmdlKSooaC1wYWQqMik7Y29uc3QgeUw9aC1wYWQtKChiLmwtbWluKS9yYW5nZSkqKGgtcGFkKjIpO2NvbnN0IHlPPWgtcGFkLSgoYi5vLW1pbikvcmFuZ2UpKihoLXBhZCoyKTtjb25zdCB5Qz1oLXBhZC0oKGIuYy1taW4pL3JhbmdlKSooaC1wYWQqMik7Y29uc3QgdXA9Yi5jPj1iLm87Y3R4LnN0cm9rZVN0eWxlPXVwPycjNmFiZDc0JzonI2UwNWQ1ZCc7Y3R4LmxpbmVXaWR0aD0yO2N0eC5iZWdpblBhdGgoKTtjdHgubW92ZVRvKHgseUgpO2N0eC5saW5lVG8oeCx5TCk7Y3R4LnN0cm9rZSgpO2NvbnN0IHRvcD1NYXRoLm1pbih5Tyx5QyksYm90PU1hdGgubWF4KHlPLHlDKTtjdHguZmlsbFN0eWxlPXVwPycjNmFiZDc0JzonI2UwNWQ1ZCc7Y3R4LmZpbGxSZWN0KHgtYm9keVcvMix0b3AsYm9keVcsTWF0aC5tYXgoMixib3QtdG9wKSl9fQogIGZ1bmN0aW9uIGRyYXdUcmVuZChjYW52YXMsYmFycyl7ZHJhd0NhbmRsZUNoYXJ0KGNhbnZhcyxiYXJzKX0KICBmdW5jdGlvbiBkcmF3UmlzayhjYW52YXMsYmFycyl7ZHJhd0NhbmRsZUNoYXJ0KGNhbnZhcyxiYXJzKX0KCiAgZnVuY3Rpb24gZ2V0U2VsZWN0ZWRGdXR1cmVzKCl7cmV0dXJuIEFycmF5LmZyb20oZnV0dXJlc1NlbC5zZWxlY3RlZE9wdGlvbnMpLm1hcChvPT5vLnZhbHVlKX0KICBmdW5jdGlvbiBzaG93UHJlcEhlYWRlcihtYXJrZXRzKXtub3dFbC50ZXh0Q29udGVudD1uZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCk7Zm9jdXNFbC50ZXh0Q29udGVudD1tYXJrZXRzLmpvaW4oJywgJyl9CiAgZnVuY3Rpb24gbWFrZUxpbmtzKG1hcmtldHMpe2NvbnN0IHE9ZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldHMuam9pbignICcpfHwnRVMgTlEnKTtsaW5rc0VsLmlubmVySFRNTD1gPGxpPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPWluZGV4K2Z1dHVyZXMiPkluZGV4IEZ1dHVyZXMgU25hcHNob3Q8L2E+PC9saT48bGk+PGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vc2VhcmNoP3E9dG9kYXkrZWNvbm9taWMrY2FsZW5kYXIiPkVjb25vbWljIENhbGVuZGFyPC9hPjwvbGk+PGxpPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL25ld3MuZ29vZ2xlLmNvbS9zZWFyY2g/cT0ke3F9Ij5OZXdzIGZvciAke21hcmtldHMuam9pbignLCAnKX08L2E+PC9saT5gfQoKICBhc3luYyBmdW5jdGlvbiBmZXRjaEludHJhZGF5KGV0Zil7CiAgICBjb25zdCB1ID0gYGh0dHBzOi8vcXVlcnkxLmZpbmFuY2UueWFob28uY29tL3Y4L2ZpbmFuY2UvY2hhcnQvJHtlbmNvZGVVUklDb21wb25lbnQoZXRmKX0/cmFuZ2U9MWQmaW50ZXJ2YWw9MW0maW5jbHVkZVByZVBvc3Q9dHJ1ZWA7CiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2hXaXRoRmFsbGJhY2sodSwnanNvbicsMTAwMDApOwogICAgaWYoIXIub2spIHRocm93IG5ldyBFcnJvcihyLmVycm9yfHwnZmV0Y2ggZmFpbGVkJyk7CiAgICBjb25zdCBkPXIuZGF0YT8uY2hhcnQ/LnJlc3VsdD8uWzBdOyBjb25zdCBxPWQ/LmluZGljYXRvcnM/LnF1b3RlPy5bMF07IGNvbnN0IHRzPWQ/LnRpbWVzdGFtcHx8W107CiAgICBjb25zdCBvdXQ9W107IGZvcihsZXQgaT0wO2k8dHMubGVuZ3RoO2krKyl7Y29uc3Qgbz1xPy5vcGVuPy5baV0saD1xPy5oaWdoPy5baV0sbD1xPy5sb3c/LltpXSxjPXE/LmNsb3NlPy5baV0sdj1xPy52b2x1bWU/LltpXTsgaWYoW28saCxsLGMsdl0uZXZlcnkoeD0+eCE9bnVsbCkpIG91dC5wdXNoKHt0OnRzW2ldKjEwMDAsbyxoLGwsYyx2fSl9CiAgICBjb25zdCByZWc9ZD8ubWV0YT8uY3VycmVudFRyYWRpbmdQZXJpb2Q/LnJlZ3VsYXI7IGNvbnN0IHJlZ1N0YXJ0PXJlZz8uc3RhcnQ/cmVnLnN0YXJ0KjEwMDA6bnVsbDsgY29uc3QgcmVnRW5kPXJlZz8uZW5kP3JlZy5lbmQqMTAwMDpudWxsOwogICAgcmV0dXJuIHtiYXJzOm91dCxyZWdTdGFydCxyZWdFbmQscHJveHk6ci51c2VkfTsKICB9CiAgZnVuY3Rpb24gZmlsdGVyVG9TZXNzaW9uKGJhcnMscmVnU3RhcnQscmVnRW5kKXtpZihyZWdTdGFydCYmcmVnRW5kKXtyZXR1cm4gYmFycy5maWx0ZXIoYj0+Yi50Pj1yZWdTdGFydCAmJiBiLnQ8PU1hdGgubWluKERhdGUubm93KCkscmVnRW5kKSl9cmV0dXJuIGJhcnMuc2xpY2UoLTM5MCl9CiAgZnVuY3Rpb24gc2VsZWN0V2luZG93KGJhcnMsbWludXRlcyl7aWYoIWJhcnMubGVuZ3RoKXJldHVybltdO2NvbnN0IGRlc2lyZWQ9TWF0aC5tYXgoMTUsbWludXRlcyk7Y29uc3QgY3V0b2ZmPURhdGUubm93KCktbWludXRlcyo2MCoxMDAwO2xldCByZWNlbnQ9YmFycy5maWx0ZXIoYj0+Yi50Pj1jdXRvZmYpO2lmKHJlY2VudC5sZW5ndGg8ZGVzaXJlZClyZWNlbnQ9YmFycy5zbGljZSgtZGVzaXJlZCk7aWYocmVjZW50Lmxlbmd0aD5kZXNpcmVkKzIpcmVjZW50PXJlY2VudC5zbGljZSgtZGVzaXJlZCk7cmV0dXJuIHJlY2VudH0KICBmdW5jdGlvbiBzdGF0c1RyZW5kKHdpbmRvd0JhcnMpe2lmKHdpbmRvd0JhcnMubGVuZ3RoPDUpIHJldHVybiB7b2s6ZmFsc2UscmVhc29uOidub3QgZW5vdWdoIGJhcnMnfTtjb25zdCBjbG9zZXM9d2luZG93QmFycy5tYXAoYj0+Yi5jKSx2b2xzPXdpbmRvd0JhcnMubWFwKGI9PmIudik7Y29uc3QgZmlyc3Q9Y2xvc2VzWzBdLGxhc3Q9Y2xvc2VzLmF0KC0xKTtjb25zdCBwY3Q9KGxhc3QtZmlyc3QpL2ZpcnN0KjEwMDtjb25zdCByZXRzPVtdO2ZvcihsZXQgaT0xO2k8Y2xvc2VzLmxlbmd0aDtpKyspe2NvbnN0IHI9KGNsb3Nlc1tpXS1jbG9zZXNbaS0xXSkvY2xvc2VzW2ktMV07aWYoaXNGaW5pdGUocikpcmV0cy5wdXNoKHIpfWNvbnN0IG1lYW49cmV0cy5yZWR1Y2UoKGEsYik9PmErYiwwKS9NYXRoLm1heCgxLHJldHMubGVuZ3RoKTtjb25zdCB2YXJyPXJldHMucmVkdWNlKChhLGIpPT5hKyhiLW1lYW4pKihiLW1lYW4pLDApL01hdGgubWF4KDEscmV0cy5sZW5ndGgpO2NvbnN0IHN0ZD1NYXRoLnNxcnQodmFycik7Y29uc3Qgdm9sTWVkPVsuLi52b2xzXS5zb3J0KChhLGIpPT5hLWIpW01hdGguZmxvb3Iodm9scy5sZW5ndGgvMildfHwxO2NvbnN0IHZvbEF2Zz12b2xzLnJlZHVjZSgoYSxiKT0+YStiLDApL3ZvbHMubGVuZ3RoO2NvbnN0IHZvbFJhdGlvPXZvbEF2Zy8odm9sTWVkfHwxKTtsZXQgc3g9MCxzeT0wLHN4eD0wLHN4eT0wO2ZvcihsZXQgaT0wO2k8Y2xvc2VzLmxlbmd0aDtpKyspe3N4Kz1pO3N5Kz1jbG9zZXNbaV07c3h4Kz1pKmk7c3h5Kz1pKmNsb3Nlc1tpXX1jb25zdCBuPWNsb3Nlcy5sZW5ndGgsZGVuPShuKnN4eC1zeCpzeCl8fDE7Y29uc3Qgc2xvcGU9KG4qc3h5LXN4KnN5KS9kZW47Y29uc3Qgc2xvcGVQY3RQZXJIb3VyPShzbG9wZS9maXJzdCkqNjAqMTAwO2xldCBkaXJlY3Rpb249J1NpZGV3YXlzJyxkaXJDbGFzcz0nd2Fybic7aWYocGN0Pj0wLjJ8fHNsb3BlUGN0UGVySG91cj49MC41KXtkaXJlY3Rpb249J1VwdHJlbmQnO2RpckNsYXNzPSdvayd9ZWxzZSBpZihwY3Q8PS0wLjJ8fHNsb3BlUGN0UGVySG91cjw9LTAuNSl7ZGlyZWN0aW9uPSdEb3dudHJlbmQnO2RpckNsYXNzPSdiYWQnfWNvbnN0IGJ1c3k9KHN0ZD49MC4wMDA2KXx8KHZvbFJhdGlvPj0xLjIpO2NvbnN0IGJ1c3lMYWJlbD1idXN5PydCdXN5JzonQ2FsbWVyJyxidXN5Q2xhc3M9YnVzeT8nb2snOid3YXJuJztyZXR1cm57b2s6dHJ1ZSxwY3Qsc3RkLHZvbFJhdGlvLHNsb3BlUGN0UGVySG91cixkaXJlY3Rpb24sZGlyQ2xhc3MsYnVzeUxhYmVsLGJ1c3lDbGFzc319CiAgZnVuY3Rpb24gc2V0TGVnZW5kKGVsKXtlbC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJpdGVtIj48c3BhbiBjbGFzcz0ic3dhdGNoIiBzdHlsZT0iYmFja2dyb3VuZDojNmFiZDc0Ij48L3NwYW4+IFVwPC9zcGFuPjxzcGFuIGNsYXNzPSJpdGVtIj48c3BhbiBjbGFzcz0ic3dhdGNoIiBzdHlsZT0iYmFja2dyb3VuZDojZTA1ZDVkIj48L3NwYW4+IERvd248L3NwYW4+YH0KCiAgbGV0IHRyZW5kTWludXRlcz0xNTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGZTZWcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZT0+e2NvbnN0IGI9ZS50YXJnZXQuY2xvc2VzdCgnYnV0dG9uW2RhdGEtdGZdJyk7aWYoIWIpcmV0dXJuO3RyZW5kTWludXRlcz1wYXJzZUludChiLmRhdGFzZXQudGYsMTApfHwxNTtkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjdGZTZWcgLnRhYmJ0bicpLmZvckVhY2goeD0+eC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLHg9PT1iKSk7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZW5kV2luJykudGV4dENvbnRlbnQ9dHJlbmRNaW51dGVzKydtJztkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlza1dpbicpLnRleHRDb250ZW50PXRyZW5kTWludXRlcysnbSd9KTsKCiAgZnVuY3Rpb24gZ2V0U2VsZWN0ZWQoKXtjb25zdCBhPWdldFNlbGVjdGVkRnV0dXJlcygpO3JldHVybiBhLmxlbmd0aD9hOlsnRVMnXX0KCiAgYXN5bmMgZnVuY3Rpb24gYnVpbGRUcmVuZChtYXJrZXRzKXsKICAgIGNvbnN0IGV0Zj1GVVRVUkVTX1RPX0VURlttYXJrZXRzWzBdfHwnRVMnXXx8J1NQWSc7IHRyZW5kU3ltRWwudGV4dENvbnRlbnQ9ZXRmOyB0cmVuZFRpbWVFbC50ZXh0Q29udGVudD1uZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCk7CiAgICB0cmVuZFN1bW1hcnlFbC5pbm5lckhUTUw9JzxzcGFuIGNsYXNzPSJtdXRlZCI+PHNwYW4gY2xhc3M9ImNoaXAiPkxvYWRpbmcgWWFob28gMW3igKY8L3NwYW4+PC9zcGFuPic7IHRyZW5kQWR2aWNlRWwudGV4dENvbnRlbnQ9Jyc7CiAgICB0cnl7CiAgICAgIGNvbnN0IGFsbD1hd2FpdCBmZXRjaEludHJhZGF5KGV0Zik7IGNvbnN0IGJhcnM9c2VsZWN0V2luZG93KGZpbHRlclRvU2Vzc2lvbihhbGwuYmFycyxhbGwucmVnU3RhcnQsYWxsLnJlZ0VuZCksdHJlbmRNaW51dGVzKTsKICAgICAgZHJhd1RyZW5kKHRyZW5kQ2FudmFzLGJhcnMpOyBzZXRMZWdlbmQodHJlbmRMZWdlbmQpOwogICAgICBjb25zdCBpbmZvPXN0YXRzVHJlbmQoYmFycyk7CiAgICAgIGlmKCFpbmZvLm9rKXt0cmVuZFN1bW1hcnlFbC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJtdXRlZCI+VHJlbmQgdW5hdmFpbGFibGUgKCR7aW5mby5yZWFzb259KTwvc3Bhbj5gO3JldHVybn0KICAgICAgY29uc3QgZGlyUGlsbD1gPHNwYW4gY2xhc3M9InBpbGwgJHtpbmZvLmRpckNsYXNzfSI+JHtpbmZvLmRpcmVjdGlvbn08L3NwYW4+YCwgYnVzeVBpbGw9YDxzcGFuIGNsYXNzPSJwaWxsICR7aW5mby5idXN5Q2xhc3N9Ij4ke2luZm8uYnVzeUxhYmVsfTwvc3Bhbj5gOwogICAgICB0cmVuZFN1bW1hcnlFbC5pbm5lckhUTUw9YCR7ZGlyUGlsbH0gJHtidXN5UGlsbH0gPHNwYW4gY2xhc3M9Im11dGVkIj52aWEgPGI+JHthbGwucHJveHl9PC9iPjwvc3Bhbj5gOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlbmRSZWYnKS50ZXh0Q29udGVudD1uZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpOwogICAgICBjaGlwRGF0YS5jbGFzc05hbWU9J2NoaXAgb2snOyBjaGlwRGF0YS5pbm5lckhUTUw9JzxpIGNsYXNzPSJmYS1zb2xpZCBmYS1jaGFydC1saW5lIj48L2k+IERhdGEgT0snOwogICAgfWNhdGNoKGUpewogICAgICB0cmVuZFN1bW1hcnlFbC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJjaGlwIGJhZCI+RGF0YSBlcnJvcjwvc3Bhbj4gJHtTdHJpbmcoZSkuc2xpY2UoMCwxNjApfSDigJQgdHJ5IGFkZGluZyBhIEN1c3RvbSBQcm94eSBpbiBTZXR0aW5ncy5gOwogICAgICBjaGlwRGF0YS5jbGFzc05hbWU9J2NoaXAgYmFkJzsgY2hpcERhdGEuaW5uZXJIVE1MPSc8aSBjbGFzcz0iZmEtc29saWQgZmEtY2hhcnQtbGluZSI+PC9pPiBEYXRhIEZBSUwnOwogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gYnVpbGRSaXNrKG1hcmtldHMpewogICAgY29uc3QgZXRmPUZVVFVSRVNfVE9fRVRGW21hcmtldHNbMF18fCdFUyddfHwnU1BZJzsgcmlza1N5bUVsLnRleHRDb250ZW50PWV0Zjsgcmlza1RpbWVFbC50ZXh0Q29udGVudD1uZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCk7CiAgICByaXNrU3VtbWFyeUVsLmlubmVySFRNTD0nPHNwYW4gY2xhc3M9Im11dGVkIj48c3BhbiBjbGFzcz0iY2hpcCI+TG9hZGluZyBZYWhvbyAxbeKApjwvc3Bhbj48L3NwYW4+Jzsgcmlza0FkdmljZUVsLnRleHRDb250ZW50PScnOwogICAgdHJ5ewogICAgICBjb25zdCBhbGw9YXdhaXQgZmV0Y2hJbnRyYWRheShldGYpOyBjb25zdCBiYXJzPXNlbGVjdFdpbmRvdyhmaWx0ZXJUb1Nlc3Npb24oYWxsLmJhcnMsYWxsLnJlZ1N0YXJ0LGFsbC5yZWdFbmQpLHRyZW5kTWludXRlcyk7CiAgICAgIGRyYXdSaXNrKHJpc2tDYW52YXMsYmFycyk7IHNldExlZ2VuZChyaXNrTGVnZW5kKTsKICAgICAgY29uc3QgaW5mbz1zdGF0c1RyZW5kKGJhcnMpOyBjb25zdCBhZHZpY2U9KGluZm8uZGlyZWN0aW9uPT09J1VwdHJlbmQnJiZpbmZvLmJ1c3lMYWJlbD09PSdCdXN5Jyk/J0J1eSc6J1dhaXQnOwogICAgICByaXNrU3VtbWFyeUVsLmlubmVySFRNTD1gPHNwYW4gY2xhc3M9InBpbGwgJHtpbmZvLmRpckNsYXNzfSI+JHtpbmZvLmRpcmVjdGlvbn08L3NwYW4+IDxzcGFuIGNsYXNzPSJwaWxsICR7aW5mby5idXN5Q2xhc3N9Ij4ke2luZm8uYnVzeUxhYmVsfTwvc3Bhbj4gPHNwYW4gY2xhc3M9Im11dGVkIj52aWEgPGI+JHthbGwucHJveHl9PC9iPjwvc3Bhbj5gOwogICAgICByaXNrQWR2aWNlRWwuaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9InBpbGwiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHgiPiR7YWR2aWNlfTwvZGl2PmA7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaXNrUmVmJykudGV4dENvbnRlbnQ9bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKTsKICAgICAgY2hpcERhdGEuY2xhc3NOYW1lPSdjaGlwIG9rJzsgY2hpcERhdGEuaW5uZXJIVE1MPSc8aSBjbGFzcz0iZmEtc29saWQgZmEtY2hhcnQtbGluZSI+PC9pPiBEYXRhIE9LJzsKICAgIH1jYXRjaChlKXsKICAgICAgcmlza1N1bW1hcnlFbC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJjaGlwIGJhZCI+RGF0YSBlcnJvcjwvc3Bhbj4gJHtTdHJpbmcoZSkuc2xpY2UoMCwxNjApfSDigJQgdHJ5IGFkZGluZyBhIEN1c3RvbSBQcm94eSBpbiBTZXR0aW5ncy5gOwogICAgICBjaGlwRGF0YS5jbGFzc05hbWU9J2NoaXAgYmFkJzsgY2hpcERhdGEuaW5uZXJIVE1MPSc8aSBjbGFzcz0iZmEtc29saWQgZmEtY2hhcnQtbGluZSI+PC9pPiBEYXRhIEZBSUwnOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0U2VsZWN0ZWRGdXR1cmVzKCl7cmV0dXJuIEFycmF5LmZyb20oZnV0dXJlc1NlbC5zZWxlY3RlZE9wdGlvbnMpLm1hcChvPT5vLnZhbHVlKX0KICBmdW5jdGlvbiBzaG93UHJlcEhlYWRlcihtYXJrZXRzKXtub3dFbC50ZXh0Q29udGVudD1uZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCk7Zm9jdXNFbC50ZXh0Q29udGVudD1tYXJrZXRzLmpvaW4oJywgJyl9CiAgZnVuY3Rpb24gbWFrZUxpbmtzKG1hcmtldHMpe2NvbnN0IHE9ZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldHMuam9pbignICcpfHwnRVMgTlEnKTtsaW5rc0VsLmlubmVySFRNTD1gPGxpPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPWluZGV4K2Z1dHVyZXMiPkluZGV4IEZ1dHVyZXMgU25hcHNob3Q8L2E+PC9saT48bGk+PGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vc2VhcmNoP3E9dG9kYXkrZWNvbm9taWMrY2FsZW5kYXIiPkVjb25vbWljIENhbGVuZGFyPC9hPjwvbGk+PGxpPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL25ld3MuZ29vZ2xlLmNvbS9zZWFyY2g/cT0ke3F9Ij5OZXdzIGZvciAke21hcmtldHMuam9pbignLCAnKX08L2E+PC9saT5gfQogIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVByZXAoKXtjb25zdCBtPWdldFNlbGVjdGVkRnV0dXJlcygpO2NvbnN0IG1hcmtldHM9bS5sZW5ndGg/bTpbJ0VTJywnTlEnXTtzaG93UHJlcEhlYWRlcihtYXJrZXRzKTttYWtlTGlua3MobWFya2V0cyk7a2V5U3RhdHVzRWwudGV4dENvbnRlbnQ9J0tleXMgb3B0aW9uYWw7IHByb3h5IGZhbGxiYWNrIGNoYWluIGFjdGl2ZS4nfQoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQnKS5vbmNsaWNrPWhhbmRsZVByZXA7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1blRyZW5kJykub25jbGljaz0oKT0+e3NldFRhYigndHJlbmQnKTsgYnVpbGRUcmVuZChnZXRTZWxlY3RlZCgpKX07CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1blJpc2snKS5vbmNsaWNrPSgpPT57c2V0VGFiKCdyaXNrJyk7IGJ1aWxkUmlzayhnZXRTZWxlY3RlZCgpKX07CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYi1wcmVwJykub25jbGljaz0oKT0+c2V0VGFiKCdwcmVwJyk7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYi10cmVuZCcpLm9uY2xpY2s9KCk9PntzZXRUYWIoJ3RyZW5kJyk7IGJ1aWxkVHJlbmQoZ2V0U2VsZWN0ZWQoKSl9OwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWItcmlzaycpLm9uY2xpY2s9KCk9PntzZXRUYWIoJ3Jpc2snKTsgYnVpbGRSaXNrKGdldFNlbGVjdGVkKCkpfTsKCiAgKGZ1bmN0aW9uKCl7Y29uc3QgYnRuPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2JpbGVNZW51Jyk7Y29uc3QgbmF2PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZpY29ucycpO2lmKGJ0biYmbmF2KXtidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT5uYXYuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpKX19KSgpOwoKICBmdW5jdGlvbiB0b2RheVN0cigpe2NvbnN0IGQ9bmV3IERhdGUoKTtyZXR1cm4gZC50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApfQogIGZ1bmN0aW9uIHJlYWRQbkwoKXt0cnl7cmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1BOTF9MT0cnKXx8J1tdJyl9Y2F0Y2goXyl7cmV0dXJuIFtdfX0KICBmdW5jdGlvbiB3cml0ZVBuTChhcnIpe2xvY2FsU3RvcmFnZS5zZXRJdGVtKCdQTkxfTE9HJyxKU09OLnN0cmluZ2lmeShhcnIpKX0KICBmdW5jdGlvbiByZW5kZXJUb2RheVBuTCgpe2NvbnN0IHJvd3M9cmVhZFBuTCgpLmZpbHRlcih4PT54LmRhdGU9PT10b2RheVN0cigpKTtpZighcm93cy5sZW5ndGgpe3BubFRvZGF5VGFibGUudGV4dENvbnRlbnQ9J+KAlCc7cmV0dXJufWNvbnN0IGh0bWw9Wyc8dGFibGUgc3R5bGU9IndpZHRoOjEwMCU7Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlIj4nLCc8dHIgY2xhc3M9Im11dGVkIj48dGQ+RGF0ZTwvdGQ+PHRkPldobzwvdGQ+PHRkPkFtb3VudDwvdGQ+PHRkPk5vdGU8L3RkPjwvdHI+J107cm93cy5mb3JFYWNoKHI9Pmh0bWwucHVzaChgPHRyPjx0ZD4ke3IuZGF0ZX08L3RkPjx0ZD4ke3Iud2hvfTwvdGQ+PHRkPiR7KHIuYW10Pj0wPycrJzonJykrci5hbXQudG9GaXhlZCgyKX08L3RkPjx0ZD4ke3Iubm90ZXx8Jyd9PC90ZD48L3RyPmApKTtodG1sLnB1c2goJzwvdGFibGU+Jyk7cG5sVG9kYXlUYWJsZS5pbm5lckhUTUw9aHRtbC5qb2luKCcnKX0KICBmdW5jdGlvbiBzdW1QbkwobmFtZSl7cmV0dXJuIHJlYWRQbkwoKS5maWx0ZXIoeD0+eC53aG89PT1uYW1lKS5yZWR1Y2UoKGEsYik9PmErYi5hbXQsMCl9CiAgZnVuY3Rpb24gc3VtUG5MVG9kYXkobmFtZSl7cmV0dXJuIHJlYWRQbkwoKS5maWx0ZXIoeD0+eC53aG89PT1uYW1lICYmIHguZGF0ZT09PXRvZGF5U3RyKCkpLnJlZHVjZSgoYSxiKT0+YStiLmFtdCwwKX0KICBmdW5jdGlvbiB1cGRhdGVQbkxDaGlwcygpe2NoaXBBSy50ZXh0Q29udGVudD0nJCcrc3VtUG5MVG9kYXkoJ0FLJykudG9GaXhlZCgyKTtjaGlwQUtBbGwudGV4dENvbnRlbnQ9JyQnK3N1bVBuTCgnQUsnKS50b0ZpeGVkKDIpO2NoaXBCRy50ZXh0Q29udGVudD0nJCcrc3VtUG5MVG9kYXkoJ0JHJykudG9GaXhlZCgyKTtjaGlwQkdBbGwudGV4dENvbnRlbnQ9JyQnK3N1bVBuTCgnQkcnKS50b0ZpeGVkKDIpfQogIGNvbnN0IHBubEFtb3VudD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG5sQW1vdW50JyksIHBubE5vdGU9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BubE5vdGUnKSwgcG5sTXNnPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbmxNc2cnKSwgcG5sVG9kYXlUYWJsZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG5sVG9kYXlUYWJsZScpLCB1bmRvTGFzdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW5kb0xhc3QnKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nUG5sJykub25jbGljaz0oKT0+e2NvbnN0IHdobz0oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0id2hvIl06Y2hlY2tlZCcpfHx7fSkudmFsdWV8fCdBSyc7Y29uc3QgYW10PXBhcnNlRmxvYXQocG5sQW1vdW50LnZhbHVlKTtpZighaXNGaW5pdGUoYW10KSl7cG5sTXNnLnRleHRDb250ZW50PSdFbnRlciBhIHZhbGlkIG51bWJlcic7c2V0VGltZW91dCgoKT0+cG5sTXNnLnRleHRDb250ZW50PScnLDEyMDApO3JldHVybn1jb25zdCBlbnRyeT17ZGF0ZTp0b2RheVN0cigpLHdobyxhbXQsbm90ZTpwbmxOb3RlLnZhbHVlLnRyaW0oKX07Y29uc3QgYXJyPXJlYWRQbkwoKTthcnIucHVzaChlbnRyeSk7d3JpdGVQbkwoYXJyKTtwbmxBbW91bnQudmFsdWU9Jyc7cG5sTm90ZS52YWx1ZT0nJztyZW5kZXJUb2RheVBuTCgpO3VwZGF0ZVBuTENoaXBzKCk7cG5sTXNnLnRleHRDb250ZW50PSdMb2dnZWQg4pyTJztzZXRUaW1lb3V0KCgpPT5wbmxNc2cudGV4dENvbnRlbnQ9JycsMTIwMCl9OwogIHVuZG9MYXN0Lm9uY2xpY2s9KCk9Pntjb25zdCBhcnI9cmVhZFBuTCgpO2lmKCFhcnIubGVuZ3RoKXJldHVybjthcnIucG9wKCk7d3JpdGVQbkwoYXJyKTtyZW5kZXJUb2RheVBuTCgpO3VwZGF0ZVBuTENoaXBzKCl9OwogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywoKT0+e2Zvcihjb25zdCBvIG9mIGZ1dHVyZXNTZWwub3B0aW9ucyl7by5zZWxlY3RlZD0oby52YWx1ZT09PSdFUyd8fG8udmFsdWU9PT0nTlEnKX1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGZTZWcgW2RhdGEtdGY9IjE1Il0nKS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtoYW5kbGVQcmVwKCk7cmVuZGVyVG9kYXlQbkwoKTt1cGRhdGVQbkxDaGlwcygpfSk7CiAgCg==';
    var code = atob(_b64);
    (0,eval)(code);
  } catch(e){ console.error('bootstrap error', e); }
})();
</script>
</body>
</html>
